<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hudongwx.drawlottery.mobile.mappers.CommodityHistoryMapper">
    <resultMap id="BaseResultMap" type="com.hudongwx.drawlottery.mobile.entitys.CommodityHistory">
        <!--
          WARNING - @mbg.generated
        -->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="commodity_id" jdbcType="BIGINT" property="commodityId"/>
        <result column="luck_code" jdbcType="VARCHAR" property="luckCode"/>
        <result column="round_time" jdbcType="VARCHAR" property="roundTime"/>
        <result column="buy_number" jdbcType="INTEGER" property="buyNumber"/>
        <result column="end_time" jdbcType="TIMESTAMP" property="endTime"/>
        <result column="luck_user_account_id" jdbcType="BIGINT" property="luckUserAccountId"/>
        <result column="cover_img_url" jdbcType="VARCHAR" property="coverImgUrl"/>
        <result column="genre" jdbcType="INTEGER" property="genre"/>
        <result column="exchange_state" jdbcType="INTEGER" property="exchangeState"/>
        <result column="buy_total_number" jdbcType="INTEGER" property="buyTotalNumber"/>
        <result column="exchange_way" jdbcType="INTEGER" property="exchangeWay"/>
        <result column="temp_id" jdbcType="BIGINT" property="tempId"/>
    </resultMap>

    <!-- 查询中奖历史-->
    <select id="selectHistoryLottery" resultMap="BaseResultMap" >
        select *  from t_commodity_history WHERE luck_user_account_id = #{accountId}
    </select>

    <!-- 查询单件历史商品信息-->
    <select id="selectBycommId" resultMap="BaseResultMap">
        select * from t_commodity_history where commodity_id = #{cmmodId}
    </select>

    <!-- 查询商品上期开奖信息 -->
    <select id="selectBycommodName" resultMap="BaseResultMap">
        select * from t_commodity_history
        <where>
            commodity_name = #{commodName}
            and round_time &lt; #{roundTime}
        </where>
        <!-- &lt; 小于     &jt; 大于 -->
    </select>

    <select id="selectComIdAndUser" resultMap="BaseResultMap">
        SELECT * FROM t_commodity_history
        WHERE commodity_id = #{commodityId} AND luck_user_account_id = #{accountId}
    </select>

    <update id="updateByIdSelective" parameterType="com.hudongwx.drawlottery.mobile.entitys.CommodityHistory">
        UPDATE  t_commodity_history
        <trim prefix="set" suffixOverrides=",">
            <if test="commodityId != null">commodity_id = #{commodityId},</if>
            <if test="luckCode != null">luck_code = #{luckCode},</if>
            <if test="tempId != null">temp_id = #{tempId},</if>
            <if test="commodityName != null">commodity_name = #{commodityName},</if>
            <if test="roundTime !=null">round_time = #{roundTime},</if>
            <if test="buyNumber !=null">buy_number = #{buyNumber},</if>
            <if test="coverImgUrl !=null">cover_img_url = #{coverImgUrl},</if>
            <if test="endTime !=null">end_time = #{endTime},</if>
            <if test="luckUserAccountId != null">luck_user_account_id =#{luckUserAccountId},</if>
            <if test="buyTotalNumber !=null">buy_total_number = #{buyTotalNumber},</if>
            <if test="exchangeState !=null">exchange_state = #{exchangeState},</if>
            <if test="exchangeWay !=null">exchange_way = #{exchangeWay},</if>
        </trim>
        WHERE id = #{id}
    </update>

    <select id="selectByTempId" resultMap="BaseResultMap">
      SELECT * FROM t_commodity_history WHERE temp_id = #{tempId}
    </select>
</mapper>